//******************************************************************************
//                                                      (c) корпорация Галактика
// Галактика 7.12 - Общие функции
// Декларирование методов объекта работы с валютами
//******************************************************************************

#doc
возвращает количество из классификатора валют (или единицу, если не указано)
#end
Function GetValSumValut(cVal: comp): double;

//******************************************************************************

#doc
возвращает курс валюты (ноль для национальной) на указанную дату
#end
Function Rate(
                        cValRate  : comp;
                        dat       : Date
         ): double;

//******************************************************************************

#doc
переводит сумму из одной валюты в другую по курсу на дату
#end
Function CurrencyExchange(
                        cValFrom  : comp;
                        Sum       : double;
                        cValTo    : comp;
                        dat       : Date
         ): double;

//******************************************************************************

#doc
Обновление временных таблиц
#end
Procedure Refresh;

//******************************************************************************

#doc
вывод отчета о ненайденных курсах валют
#end
Procedure WasErrorValut;


//******************************************************************************

#doc
вазовая валюта
#end
Function ValBase: comp;

//******************************************************************************

#doc
наименование базовой валюты
#end
Function ValBaseName: string[30];

//******************************************************************************

#doc
символ базовой валюты
#end
Function ValBaseSimv: string[6];

//******************************************************************************

#doc
валюта отчетов
#end
Function ValTar: comp;

//******************************************************************************

#doc
наименование валюты отчетов
#end
Function ValTarName: string[30];

//******************************************************************************

#doc
символ валюты отчетов
#end
Function ValTarSimv: string[6];

//******************************************************************************

#doc
наименование национальной валюты
#end
Function ValNatName: string[30];

//******************************************************************************

#doc
символ национальной валюты
#end
Function ValNatSimv: string[6];

//******************************************************************************
// использовать вместо GetSimvAndName

#doc
возвращает символ и наименование валюты в !!!ТВОРИТЕЛЬНОМ ПАДЕЖЕ!!!
национальную тоже понимает, возвращает соответсвующие настройки
#end
Function GetValSimvName(
                        cVal     : comp;
                        var Simv : string;
                        var Name : string
         ): boolean;

//******************************************************************************

#doc
возвращает символ валюты
#end
Function GetValSimv(_cVal: comp): string;

//******************************************************************************

#doc
возвращает наименование валюты
#end
Function GetValName(_cVal: comp): string;

//******************************************************************************

#doc
инициализация переменных объектного интерфейса для работоспособности некоторых функций
#end
Procedure InitVars;

//******************************************************************************

#doc
инициализация объектного интерфейса
#end
Procedure InitVal;

//******************************************************************************
// вызывать перед ShowFile для вывода сообщения в случае, если при пересчете курсов были ошибки

#doc
вызывать перед ShowFile для вывода сообщения в случае, если при пересчете курсов были ошибки
#end
Procedure DoneVal;

//******************************************************************************

#doc
поиск курса валюты cVal на дату DAT
#end
Function GetCurse(
                        var _cVal  : comp;
                        var dat    : Date;
                        var kurs   : double
                 ): boolean;

//******************************************************************************

#doc
#end
Function GetCurrencyPrimitive(
                        var ValSrc   : comp;
                        var SumSrc   : double;
                        var ValTo    : comp;
                        var dCourse  : Date
         ): double;

//******************************************************************************

#doc
возврат суммы в валюте отчетов
#end
Function GetCurrency(
                        var ValSrc   : comp;
                        var SumSrc   : double;
                        var dCourse  : Date
         ): double;

//******************************************************************************

#doc
возврат суммы в базовой валюте
#end
Function GetBaseCurrency(
                        var ValSrc   : comp;
                        var SumSrc   : double;
                        var dCourse  : Date
         ): double;

//******************************************************************************

#doc
возврат суммы в национальной валюте
#end
Function GetNatCurrency(
                        var ValSrc   : comp;
                        var SumSrc   : double;
                        var dCourse  : Date
         ): double;

//******************************************************************************

#doc
возврат суммы в любой заданной валюте
#end
Function GetAnyCurrency(
                        var ValSrc   : comp;
                        var SumSrc   : double;
                        var dCourse  : Date;
                        var targval  : comp
         ): double;

//******************************************************************************

#doc
возврат суммы в национальной валюте
#end
Procedure GetNatTarCurrency(
                        var ValSrc1  : comp;
                        var SumSrc1  : double;
                        var ValSrc2  : comp;
                        var SumSrc2  : double;
                        var dCourse  : Date;
                        var ResNat   : double;
                        var ResTar   : double);


//******************************************************************************

#doc
возврат суммы в валюте отчетов исходя из 2 сумм: в национальной и указанной валютах
#end
Function GetTarCurrency(
                        ValSrc   : comp;        // валюта операции
                        SumSrcV  : double;      // сумма в валюте
                        SumSrcR  : double;      // сумма в НДЕ
                        dCourse  : Date         // дата операции
         ): double;

//******************************************************************************

#doc
анализ настройки пользователя для пересчета валют
#end
Function ReCalcCursVal: boolean;

//******************************************************************************

#doc
выбор валюты Pick и пересчет сумм
#end
Function ChoiceVal(
                        var ValSrc  : comp;
                        var dCourse: Date;
                        var SumSrc  : double;
                        var SumSrcV: double
         ): boolean;

//******************************************************************************

#doc
обработка сумм в НДЕ, валюте и даты операции
пересчет сумм в валюте (НДЕ) при корректировке соответсвующего поля
#end
Procedure ReCalcSumRubVal(
                        isSumRub     : boolean;  //true-коррект. сумма в НДЕ = CurField
                        dCourse      : Date;
                        var ValSrc   : comp;
                        var SumSrc   : double;
                        var SumSrcV  : double);

//******************************************************************************

#doc
пересчет суммы в валюте в РУБЛИ с учетом процента к курсу
if OkPlus = TRUE  -> сколько должен заплатить учетом процента
          = FALSE -> сколько заплачено фактически с учетом процента
#end
Function CalcRubValMoney(
                        OkPlus   : boolean;
                        ValSrc   : comp;
                        dCourse  : Date;
                        sCourse  : double;
                        SumProc  : double;
                        SumSrcV  : double
         ): double;

//******************************************************************************


#doc
пересчет суммы в рублях в ВАЛЮТУ с учетом процента к курсу
#end
Function CalcValRubMoney(
                        ValSrc   : comp;
                        dCourse  : Date;
                        sCourse  : double;
                        SumProc  : double;
                        SumSrcR  : double
         ): double;

//******************************************************************************

#doc
пересчет суммы ВАЛЮТЕ в РУБЛИ с учетом процента к курсу
#end
Function CalcSumValRubDO(
                        ValSrc   :  comp;
                        dCourse  :  Date;
                        sCourse  :  double;
                        SumProc  :  double;
                        SumSrcV  :  double
         ): double;

//******************************************************************************
#ifdef _ValFuncV2_

#doc
пересчет суммы в валюте в рубли и наоборот
#end
Function CheckSumVal(
                        ValSrc       : comp;
                        dCourse      : Date;
                        var SumSrc   : double;
                        var SumSrcV  : double
         ): boolean;

#end
//******************************************************************************
